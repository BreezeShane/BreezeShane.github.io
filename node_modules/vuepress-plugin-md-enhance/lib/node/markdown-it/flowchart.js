"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/* eslint-disable max-statements */
const hash = require("hash-sum");
const flowchartRender = (tokens, idx) => {
    const token = tokens[idx];
    const key = `flowchart-${hash(idx)}`;
    const { content, info } = token;
    return `<FlowChart id="${key}" data-code="${encodeURIComponent(content)}" preset="${info.trim().split(":")[1] || "vue"}"></FlowChart>`;
};
const flowchart = (md) => {
    // Handle ```flow and ```flowchart blocks
    const fence = md.renderer.rules.fence;
    md.renderer.rules.fence = (...args) => {
        const [tokens, idx] = args;
        const { info } = tokens[idx];
        const realInfo = info.trim().split(":")[0];
        if (realInfo === "flow" || realInfo === "flowchart")
            return flowchartRender(tokens, idx);
        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion
        return fence(...args);
    };
    md.renderer.rules.flowchart = flowchartRender;
};
exports.default = flowchart;
//# sourceMappingURL=flowchart.js.map